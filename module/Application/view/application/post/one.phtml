<?php $post = $this->post;
$isAuthor = $this->isAuthor;
?>

<div class="row">
    <div class="col-md-9">
        <h1 class="display-4"><?php echo $post->getTitle() ?></h1>
    </div>
    <div class="col-md-3">
    </div>
</div>

<div>
    <span>
        <?php if (!$isAuthor) { ?>
            <?php if ($this->isSaved) { ?>
                <a href="/post/deletesaved/<?php echo $post->getId() ?>" title="Delete from Saved">
                    <i class="fas fa-star"></i>
                </a>
            <?php } else { ?>
                <a href="/post/addtosaved/<?php echo $post->getId() ?>" title="Add to Saved">
                    <i class="far fa-star"></i>
                </a>
            <?php } ?>
        <?php } else { ?>
            <?php if ($post->canBeEdit()) { ?>
                <a href="/post/edit/<?php echo $post->getId() ?>" class="btn btn-sm btn-outline-dark">Edit</a>
            <?php } ?>
            <a href="/post/delete/<?php echo $post->getId() ?>" class="btn btn-sm btn-outline-dark">Delete</a>
        <?php } ?>
    </span>

    <span class="float-right">
        <?php if (!$isAuthor) { ?>
            <?php if (!$this->isBlocked) { ?>
                <a href="/user/block/<?php echo $post->getUser()->getId() ?>"
                   title="Block author">
                    <i class="fas fa-user-alt-slash"></i>
                </a>
            <?php } else { ?>
                <a href="/user/unblock/<?php echo $post->getUser()->getId() ?>"
                   title="Unblock author">
                    <i class="fas fa-user-alt"></i>
                </a>
            <?php } ?>
        <?php } ?>
        <b><span class="text-muted">Author: </span></b>
        <a href="/post/author/<?php echo $post->getUser()->getId() ?>">
            <i><span class="text-muted"><?php echo $post->getUser()->getLogin() ?></span></i>
        </a>
        <b><span class="text-muted">Date: </span></b>
        <i><span class="text-muted"><?php echo $post->getDate() ?></span></i>
    </span>
</div>

<div class="lead text-justify">
    <p style="margin: 10px 0 10px 0"><?php echo $post->getContent() ?></p>
</div>

<?php $count = count($post->getTags()) - 1;
if ($count >= 0) { ?>
    <b>Tags:</b>
    <?php foreach ($post->getTags() as $key => $tag) { ?>
    <a href="/post?tag=<?php echo $tag->getId() ?>">
        <?php echo $tag->getName() ?></a
        ><?php if ($key != $count) {
            echo ',';
        }
    }
} ?>

<?php
$form = $this->form;
$form->prepare();

$form->get('content')->setAttributes([
    'class' => 'form-control',
    'style' => 'width: 40%'
]);

$form->get('submit')->setAttributes([
    'class' => 'btn btn-success',
]);
?>
<hr>
<div>
    <?php echo $this->form()->openTag($form) ?>

    <div class="form-inline">
        <?php
        echo $this->formLabel($form->get('content'));
        echo $this->formElement($form->get('content'));
        echo $this->formElementErrors($form->get('content'));
        echo $this->formElement($form->get('submit'));
        ?>
    </div>

    <?php echo $this->form()->closeTag($form) ?>
</div>

<div class="style-container">
    <ul class="list-group">
        <?php foreach ($this->comments as $comment) { ?>
            <li class="list-group-item d-flex justify-content-between align-items-center">

                <span><?php echo $comment->getContent() ?></span>
                <span class="badge badge-dark badge-pill">
                    <a href="/post/author/<?php echo $comment->getUser()->getId() ?>">
                        <?php echo $comment->getUser()->getLogin() ?>
                    </a>
                    <?php echo $comment->getDate() ?>
                </span>
            </li>
        <?php } ?>
    </ul>

    <br>
    <?php
    echo $this->paginationControl($this->comments,
        'Sliding',
        'application/partial/paginator',
        ['route' => 'post', 'action' => 'one', 'id' => $post->getId()]);
    ?>

</div>

